#Centralized DynamoDB writer function

import json
import time

import boto3
from decimal import *

ssm = boto3.client('ssm')
table = ssm.get_parameter(Name="LambdaMTExp_DDB_Table")['Parameter']['Value']
dynamodb_table = boto3.resource('dynamodb').Table(table)

def write(payload):
    data = {}

    data['pk']        = "Lambda_" + payload['memory'] + "_" + payload['workers'] + "_" + payload['arch'] #Lambda + MEMORY + WORKERS ("Lambda_128_1_x86")
    data['sk']        = time.strftime("%Y%m%d_%H%M%S")
    data['cores']     = payload['cores']
    data['proc_time'] = Decimal(str(payload['proc_time']))

    response = dynamodb_table.put_item(
        Item=data,
        ReturnConsumedCapacity='TOTAL'
    )
    print(response)

    return response